---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# apodR

The goal of apodR is to connect R to the NASA APOD API. The APOD API supports one image at a time. In order to suplly more than that, this package also includes creating time ranges (of less than 1000 days ata time) and some historical data in tibble format.

Thanks to Michael W. Kearney, author of [Rtweet](http://rtweet.info), for having a robust package based on connecting to an API. I didn't know much about APIs when I started this project and looking at his source code helped a ton! 

## Installation

You can install the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("eringrand/apodR")
```
## Example

This is a basic example to retrive APOD data. 

```{r example1}
library(apodR)
get_apod() # no imputs will get today's image
```


You can also supply a start and end date to get a range of image results back.
```{r}
get_apod(start_date = "2018-04-01", end_date = "2018-04-03")
```




With a little `magick` you can also save the APOD image to your computer for use later. 
This is a demostration of a picture in APOD I helped to create!
```{r}
library(magick)
library(gmp)
library(stringr)
library(dplyr)

save_image <- function(url){
  image <- try(image_read(url), silent = FALSE)
  image_name <- stringr::str_extract(m31$hdurl, "([^\\/]+$)")
  image_loc <- here::here("man/figures/README", image_name)
  if(class(image)[1] != "try-error"){
    image %>%
    image_write(image_loc)
  }
  return(image)
}

m31 <- get_apod(start_date = "2009-09-17")  # only providing a start date will give the image just for that day
pull(m31, explanation)
save_image(m31$hdurl)
```

![](man/figures/README/Swift_M31_large_UV70p.jpg)
